input: |
  # These are active when we have focus on the draft window
  title:Talon Draft
  -
  settings():
    # Enable 'Smart dictation mode', see https://github.com/knausj85/knausj_talon/pull/356
    user.context_sensitive_dictation = 1

  # Replace a single word with a phrase
  replace <user.draft_anchor> with <user.text>:
    user.draft_select("{draft_anchor}")
    result = user.formatted_text(text, "NOOP")
    insert(result)

  # Position cursor before word
  (pre | cursor | cursor before) <user.draft_anchor>:
    user.draft_position_caret("{draft_anchor}")

  # Position cursor after word
  (post | cursor after) <user.draft_anchor>:
    user.draft_position_caret("{draft_anchor}", 1)

  # Select a whole word
  (take | select) <user.draft_anchor>:
    user.draft_select("{draft_anchor}")

  # Select a range of words
  (take | select) <user.draft_anchor> (through | past) <user.draft_anchor>:
    user.draft_select("{draft_anchor_1}", "{draft_anchor_2}")

  # Delete a word
  (change | chuck | clear) <user.draft_anchor>:
    user.draft_select("{draft_anchor}", "", 1)
    key(backspace)

  # Delete a range of words
  (change | chuck | clear) <user.draft_anchor> (through | past) <user.draft_anchor>:
    user.draft_select(draft_anchor_1, draft_anchor_2, 1)
    key(backspace)

  # reformat word
  <user.formatters> word <user.draft_anchor>:
    user.draft_select("{draft_anchor}", "", 1)
    user.formatters_reformat_selection(user.formatters)

  # reformat range
  <user.formatters> <user.draft_anchor> (through | past) <user.draft_anchor>:
      user.draft_select(draft_anchor_1, draft_anchor_2, 1)
      user.formatters_reformat_selection(user.formatters)
output:
  children:
  - text: '# These are active when we have focus on the draft window'
    type: comment
  - children:
    - children:
      - text: title
        type: identifier
      - text: Talon Draft
        type: implicit_string
      key:
        text: title
        type: identifier
      pattern:
        text: Talon Draft
        type: implicit_string
      type: match
    type: context
  - children:
    - text: '# Enable ''Smart dictation mode'', see https://github.com/knausj85/knausj_talon/pull/356'
      type: comment
    - children:
      - children:
        - text: user.context_sensitive_dictation
          type: identifier
        - text: '1'
          type: integer
        left:
          text: user.context_sensitive_dictation
          type: identifier
        right:
          text: '1'
          type: integer
        type: assignment
      type: block
    type: settings
  - text: '# Replace a single word with a phrase'
    type: comment
  - children:
    - children:
      - children:
        - text: replace
          type: word
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - text: with
          type: word
        - capture_name:
            text: user.text
            type: identifier
          children:
          - text: user.text
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      - children:
        - text: result
          type: identifier
        - action_name:
            text: user.formatted_text
            type: identifier
          arguments:
            children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.formatted_text
            type: identifier
          - children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          type: action
        left:
          text: result
          type: identifier
        right:
          action_name:
            text: user.formatted_text
            type: identifier
          arguments:
            children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.formatted_text
            type: identifier
          - children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          type: action
        type: assignment
      - children:
        - action_name:
            text: insert
            type: identifier
          arguments:
            children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          children:
          - text: insert
            type: identifier
          - children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          type: action
        expression:
          action_name:
            text: insert
            type: identifier
          arguments:
            children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          children:
          - text: insert
            type: identifier
          - children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - text: replace
          type: word
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - text: with
          type: word
        - capture_name:
            text: user.text
            type: identifier
          children:
          - text: user.text
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      - children:
        - text: result
          type: identifier
        - action_name:
            text: user.formatted_text
            type: identifier
          arguments:
            children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.formatted_text
            type: identifier
          - children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          type: action
        left:
          text: result
          type: identifier
        right:
          action_name:
            text: user.formatted_text
            type: identifier
          arguments:
            children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.formatted_text
            type: identifier
          - children:
            - children:
              - text: text
                type: identifier
              type: variable
              variable_name:
                text: text
                type: identifier
            - children:
              - text: NOOP
                type: string_content
              type: string
            type: argument_list
          type: action
        type: assignment
      - children:
        - action_name:
            text: insert
            type: identifier
          arguments:
            children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          children:
          - text: insert
            type: identifier
          - children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          type: action
        expression:
          action_name:
            text: insert
            type: identifier
          arguments:
            children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          children:
          - text: insert
            type: identifier
          - children:
            - children:
              - text: result
                type: identifier
              type: variable
              variable_name:
                text: result
                type: identifier
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  - text: '# Position cursor before word'
    type: comment
  - children:
    - children:
      - children:
        - children:
          - children:
            - text: pre
              type: word
            - text: cursor
              type: word
            - children:
              - text: cursor
                type: word
              - text: before
                type: word
              type: seq
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - children:
          - children:
            - text: pre
              type: word
            - text: cursor
              type: word
            - children:
              - text: cursor
                type: word
              - text: before
                type: word
              type: seq
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  - text: '# Position cursor after word'
    type: comment
  - children:
    - children:
      - children:
        - children:
          - children:
            - text: post
              type: word
            - children:
              - text: cursor
                type: word
              - text: after
                type: word
              type: seq
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - children:
          - children:
            - text: post
              type: word
            - children:
              - text: cursor
                type: word
              - text: after
                type: word
              type: seq
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_position_caret
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_position_caret
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  - text: '# Select a whole word'
    type: comment
  - children:
    - children:
      - children:
        - children:
          - children:
            - text: take
              type: word
            - text: select
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - children:
          - children:
            - text: take
              type: word
            - text: select
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  - text: '# Select a range of words'
    type: comment
  - children:
    - children:
      - children:
        - children:
          - children:
            - text: take
              type: word
            - text: select
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - children:
          - children:
            - text: through
              type: word
            - text: past
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - children:
          - children:
            - text: take
              type: word
            - text: select
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - children:
          - children:
            - text: through
              type: word
            - text: past
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_1
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor_2
                type: string_content
              - text: '}'
                type: string_content
              type: string
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  - text: '# Delete a word'
    type: comment
  - children:
    - children:
      - children:
        - children:
          - children:
            - text: change
              type: word
            - text: chuck
              type: word
            - text: clear
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        expression:
          arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        type: expression
      type: block
    rule:
      children:
      - children:
        - children:
          - children:
            - text: change
              type: word
            - text: chuck
              type: word
            - text: clear
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        expression:
          arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        type: expression
      type: block
    type: command
  - text: '# Delete a range of words'
    type: comment
  - children:
    - children:
      - children:
        - children:
          - children:
            - text: change
              type: word
            - text: chuck
              type: word
            - text: clear
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - children:
          - children:
            - text: through
              type: word
            - text: past
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        expression:
          arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        type: expression
      type: block
    rule:
      children:
      - children:
        - children:
          - children:
            - text: change
              type: word
            - text: chuck
              type: word
            - text: clear
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - children:
          - children:
            - text: through
              type: word
            - text: past
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        expression:
          arguments:
            text: backspace
            type: implicit_string
          children:
          - text: backspace
            type: implicit_string
          type: key_action
        type: expression
      type: block
    type: command
  - text: '# reformat word'
    type: comment
  - children:
    - children:
      - children:
        - capture_name:
            text: user.formatters
            type: identifier
          children:
          - text: user.formatters
            type: identifier
          type: capture
        - text: word
          type: word
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - capture_name:
            text: user.formatters
            type: identifier
          children:
          - text: user.formatters
            type: identifier
          type: capture
        - text: word
          type: word
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: '{'
                type: string_content
              - text: draft_anchor
                type: string_content
              - text: '}'
                type: string_content
              type: string
            - children: []
              type: string
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  - text: '# reformat range'
    type: comment
  - children:
    - children:
      - children:
        - capture_name:
            text: user.formatters
            type: identifier
          children:
          - text: user.formatters
            type: identifier
          type: capture
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - children:
          - children:
            - text: through
              type: word
            - text: past
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    - children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        type: expression
      type: block
    rule:
      children:
      - children:
        - capture_name:
            text: user.formatters
            type: identifier
          children:
          - text: user.formatters
            type: identifier
          type: capture
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        - children:
          - children:
            - text: through
              type: word
            - text: past
              type: word
            type: choice
          type: parenthesized_rule
        - capture_name:
            text: user.draft_anchor
            type: identifier
          children:
          - text: user.draft_anchor
            type: identifier
          type: capture
        type: seq
      type: rule
    script:
      children:
      - children:
        - action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.draft_select
            type: identifier
          arguments:
            children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          children:
          - text: user.draft_select
            type: identifier
          - children:
            - children:
              - text: draft_anchor_1
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_1
                type: identifier
            - children:
              - text: draft_anchor_2
                type: identifier
              type: variable
              variable_name:
                text: draft_anchor_2
                type: identifier
            - text: '1'
              type: integer
            type: argument_list
          type: action
        type: expression
      - children:
        - action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        expression:
          action_name:
            text: user.formatters_reformat_selection
            type: identifier
          arguments:
            children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          children:
          - text: user.formatters_reformat_selection
            type: identifier
          - children:
            - children:
              - text: user.formatters
                type: identifier
              type: variable
              variable_name:
                text: user.formatters
                type: identifier
            type: argument_list
          type: action
        type: expression
      type: block
    type: command
  type: source_file
